<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<script src="./plugins/layui/layui.js"></script>
	<link rel="stylesheet" href="./plugins/layui/css/layui.css" />
	<link rel="stylesheet" href="./src/styles/page3.css" />

	<link rel="stylesheet" href="./plugins/swiper/swiper-bundle.min.css" />
	<script src="./plugins/swiper/swiper-bundle.min.js"></script>

	<!-- 高德api -->
	<script type="text/javascript">
		window._AMapSecurityConfig = {
			securityJsCode: "6653c0473726d0f1ab5b2ab0dbe162c4",
		}
	</script>
	<script src="https://cache.amap.com/lbs/static/es5.min.js"></script>
	<script
		src="https://webapi.amap.com/maps?v=2.0&key=7262dc147356ba13dc72224c66a04e1d&plugin=AMap.DistrictSearch,AMap.MouseTool"></script>

	<title>Urban Streetscapes</title>

	<style>
		/* 1. font-face 注册  2. font-family：使用 */
		@font-face {
			font-family: "BigShouldersInlineText-Black", "PingFang";
			src: url("static/BigShouldersInlineText-Black.ttf"),
				url("static/PingFang.ttc");
		}

		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}

		p {
			display: inline;
		}

		body,
		html {
			height: 100%;
			overflow: hidden;
		}

		.swiper {
			height: 100vh;
		}

		.swiper-slide {
			height: 100vh;
			display: flex;
			flex-direction: column;
			overflow: hidden;
		}

		/* home_1页面内容 */

		.home_pre {
			width: 100%;
			min-height: 100vh;
			background: url("static/bg.jpg") no-repeat center;
			background-size: cover;
			overflow: hidden;
			display: flex;
			flex-direction: column;
			animation: bg 5s ease-in-out;
			position: relative;
			justify-content: center;
		}

		.home_pre>.content {
			width: 100%;
			position: absolute;
			z-index: 1;
			text-align: center;
			color: rgb(250, 250, 250);
			margin-top: -18%;
			letter-spacing: 1px;
			animation: title-animation 3.5s ease-in-out forwards;
		}

		.home_pre>.content>.heading {
			font-family: "BigShouldersInlineText-Black";
			font-weight: bolder;
			font-size: 200px;
			white-space: nowrap;
			text-shadow: 4px 4px 4px #000000aa;
		}

		.home_pre::before {
			width: 100%;
			height: 100%;
			content: "";
			position: absolute;
			animation: bg2 5s ease-in-out;
			background: url("static/preground.png");
			inset: 0;
			background-repeat: no-repeat;
			background-position: center;
			background-size: cover;
			overflow: hidden;
			z-index: 2;
		}

		@media screen and (max-width: 768px) {
			.home_pre>.content>.heading {
				font-size: 60px;
			}
		}

		@media screen and (max-width: 992px) {
			.home_pre>.content>.heading {
				font-size: 100px;
			}
		}

		@media screen and (min-height: 1050px) {
			.home_pre {
				font-size: 18px;
			}
		}

		@keyframes bg {
			0% {
				background-position: center -7em;
				opacity: 0;
			}

			50% {
				opacity: 1;
			}

			100% {
				background-position: center;
			}
		}

		@keyframes bg2 {
			0% {
				background-position: center -4em;
				opacity: 1;
			}

			50% {
				opacity: 1;
			}

			100% {
				background-position: center;
			}
		}

		@keyframes title-animation {
			from {
				transform: translateY(-30%);
			}

			to {
				transform: translateY(-10%);
			}
		}

		/* home_2页面内容 */

		.home {
			padding: 5px 40px 5px 50px;
			width: 100%;

			background-color: rgb(240, 240, 240);
			background-position: right;
			background-size: cover;
			overflow: auto;

			display: flex;
			flex-direction: column;
		}

		.home>.intro_pic {
			width: 100%;
			margin-bottom: 10px;
		}

		.home>.content {
			padding: 0 100px 0 100px;
			width: 100%;
		}

		.home>.content ::selection {
			background-color: rgb(207, 111, 9);
		}

		/* 嵌入文本中的容器 */
		.content_embedded {
			float: left;
			margin: 0 20px 20px 0;
			padding-top: 10px;
		}

		.content_embedded>.content_pic {
			margin-top: -130px;
			width: 400px;
		}

		.content_embedded>.video_area>video {
			padding-top: 25px;
			width: 500px;
		}

		.home>.content>.text_area_1 {
			flex: 1;
			/* 下外边距 */
			/* margin-bottom: 1px; */
			margin-top: 20px;
			text-align: center;
			line-height: 60px;
			font-weight: bold;
			font-size: 30px;
			color: #444444;
		}

		.home>.content>.text_area_2 {
			/* 下外边距 */
			font-family: "HarmonyOS_Sans_Thin";
			text-align: justify;
			margin-top: 15px;
			margin-bottom: 5px;
			line-height: 30px;
			font-weight: normal;
			font-size: 16px;
			color: #444444;
		}

		.home>.content>.text_area_2>.pic_text {
			/* 下外边距 */
			font-family: "HarmonyOS_Sans_Thin";
			text-align: left;
			margin-top: 5px;
			margin-bottom: 5px;
			line-height: 10px;
			font-weight: normal;
			font-size: 13px;
			color: #444444;
		}

		/* gallery */
		.content_gallery {
			display: flex;
			width: 50%;
			gap: 10px;
		}

		.content_gallery>.gallery_item {
			flex: 1;
			display: block;
			clear: both;
			margin-top: 10px;
		}

		.gallery_item>img {
			width: 100%;
		}

		.home>.content>.video_area {
			overflow: hidden;
		}

		/* 视频和文字统一设置样式 */
		.text_area_1,
		.text_area_2,
		.video_area {
			/* 圆角 */
			border-radius: 0px;
			/* 内边距 */
			padding: 3px;
		}

		/*  ---------------------------------------------- 切换按钮 ------------------------------------- */
		/* 第一页 */
		.lang_buttons {
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			margin-top: auto;
			width: 100%;
			z-index: 3;
		}

		.lang_btn {
			color: rgb(207, 111, 9);
			background: #fff;
			width: 20%;
			height: 30px;
			padding: 8px 20px;
			border-radius: 3em;
			font-weight: bold;
			transition: all ease-in-out 0.15s;
			display: flex;
			justify-content: center;
			align-items: center;
			cursor: pointer;
			margin-top: auto;
			margin: auto 10px 100px 10px;
			border: none;
		}

		.lang_btn:nth-child(1) {
			margin-bottom: 15px;
		}

		.lang_btn:nth-child(2) {
			margin-bottom: 100px;
		}

		.lang_btn.white {
			color: rgb(207, 111, 9);
		}

		.lang_btn.white:hover {
			color: #fff;
			background-color: rgb(207, 111, 9);
		}

		/* --------------------第二页----------------------- */
		.page_menu {
			display: flex;
			justify-content: right;
			align-items: center;
		}

		.page_change_btn {
			width: 15%;
			height: 40px;
			padding: 5px 5px;
			border-radius: 2px;
			border: none;
			font-weight: light;
			transition: all ease-in-out 0.15s;
			display: flex;
			justify-content: right;
			align-items: center;
			cursor: pointer;
		}

		/* 按钮内图标 */
		.page_change_btn>.menu_icon {
			color: #fff;
			height: 1rem;
			width: 1rem;
			margin: 20px 10px;
		}

		/* 设置文字颜色为浅色，hover后浅色 */
		.page_change_btn.white {
			color: #444444;
		}

		.page_change_btn.white:hover {
			color: rgb(207, 111, 9);
			background-color: rgba(255, 255, 255, 0.149);
		}

		/* 图标均用向下的图标，向上设置旋转180°*/
		.page_change_btn.pre>.menu_icon {
			/* color: #bd1c1c; */
			transform: rotate(180deg);
		}

		/* 设置文字颜色为深色，hover后深色 */

		.page_change_btn.black {
			color: #444444;
		}

		.page_change_btn.black:hover {
			color: rgb(207, 111, 9);
			/* background-color: rgba(255, 255, 255, 0.149); */
		}

		/* 图标均用向下的图标，向上设置旋转180°*/
		.page_change_btn.pre>.menu_icon {
			color: #444444;
			transform: rotate(180deg);
		}

		/* --------------------第三页------------------------------ */
		.page3_title {
			font-family: "PingFang";
			font-size: 25px;
			text-align: center;
			font-weight: lighter;
		}

		/* 滑块内部样式 */
		.range_btn_group {
			display: flex;
			align-items: center;
			justify-content: center;
			font-family: "PingFangSC-Thin";
			margin-bottom: 18px;
			font-size: 4px;
			color: #444444;
		}

		.range_item {
			border-bottom: 1px solid rgba(0, 0, 0, 0.25);
			padding-bottom: 20px;
			margin-bottom: 20px;
		}

		.page_intro_1 {
			width: 95%;
			padding-top: 5px;
			padding-bottom: 5px;
			display: flex;
			justify-content: left;
			align-items: center;
			line-height: 28px;
			font-size: 15px;
			font-family: "PingFangSC-Regular";
			text-align: justify;
			color: #444444;
		}

		.page_intro_2 {
			width: 95%;
			padding-top: 5px;
			padding-bottom: 5px;
			display: flex;
			justify-content: right;
			align-items: center;
			line-height: 28px;
			font-size: 15px;
			font-family: "PingFangSC-Thin";
			text-align: justify;
			color: #444444;
		}

		.page3_subtitle {
			padding-bottom: 5px;
			align-items: center;
			font-size: 20px;
			text-align: center;
			color: #444444;
			font-family: "PingFangSC-Thin";
		}
	</style>
</head>

<body>
	<div class="swiper swiper-no-swiping">
		<div class="swiper-wrapper">
			<div class="swiper-slide">
				<div class="home_pre">
					<div class="content">
						<div class="heading">HONG KONG</div>
					</div>
					<div class="lang_buttons">
						<button id="lang-btn" class="lang_btn next white" data-lang="en">
							EXPLORE（Englishg）
						</button>
						<button id="lang-btn" class="lang_btn next white" data-lang="zh">
							探索（中文）
						</button>
					</div>
				</div>
			</div>

			<div class="swiper-slide">
				<div class="home">
					<div class="page_menu">
						<div class="page_change_btn pre black" id="pre-page">
							<img class="menu_icon" src="static/icon/next_black.svg" />
							<p lang-id="page_change_1">Last Page</p>
						</div>
					</div>

					<img class="intro_pic" src="./static/hongkong3.jpg" alt="" />
					<div class="content">
						<!-- 嵌入容器 + 图片 -->
						<div class="content_embedded">
							<img class="content_pic" lang-id="TitlePic" />
						</div>

						<!-- 文本内容 -->
						<div class="text_area_1">
							<p lang-id="contentTitle">
								基于 视觉复杂度 的 香港"城市街景索引"
							</p>
						</div>
						<div class="text_area_2">
							<p lang-id="contentText_1">正文1</p>
							<!-- 多张图片并排排列的图片墙 -->
							<div class="content_gallery">
								<div class="gallery_item">
									<img src="./static/page2-0a.png" />
								</div>
							</div>
							<div class="pic_text">
								<p lang-id="picText_0a">物质构成相似的街景却有着完全不同的视觉感受</p>
							</div>

							<div class="content_gallery">
								<div class="gallery_item">
								  <img src="./static/page2-0b.png" />
								</div>
							</div>
							<div class="pic_text">
								<p lang-id="picText_0b"></p>
							</div>
			
							<div class="content_gallery">
								<div class="gallery_item">
								  <img src="./static/page2-0c.png" />
								</div>
							</div>
							<div class="pic_text">
								<p lang-id="picText_0c"></p>
							</div>

							<p lang-id="contentText_2">正文2</p>
							<!-- 多张图片并排排列的图片墙 -->
							<div class="content_gallery">
								<div class="gallery_item">
									<img src="./static/page2-1a.png" />
								</div>
							</div>
							<div class="pic_text">
								<p lang-id="picText_1">“安全性”由低到高的街景</p>
								<a href="https://ieeexplore.ieee.org/document/6910072/" lang-id="picText_2">
									（图片来源：Nikhil Naik, et al, 2014</a>
							</div>

							<div class="content_gallery">
								<div class="gallery_item">
									<img src="./static/page2-1b.png" />
								</div>
							</div>

							<div class="pic_text">
								<p lang-id="picText_3">“视觉质量”感知由低到高的街景</p>
								<a href="https://journals.sagepub.com/doi/10.1177/2399808319828734" lang-id="picText_4">
									（图片来源：Yu Ye, et al, 2019）</a>
							</div>

							<div class="content_gallery">
								<div class="gallery_item">
									<img src="./static/page2-1c.png" />
								</div>
							</div>

							<div class="pic_text">
								<p lang-id="picText_5">“美观性”感知由低到高的街景</p>
								<a href="https://link.springer.com/chapter/10.1007/978-3-319-46448-0_12"
									lang-id="picText_6">
									（图片来源：Abhimanyu Dubey, et al, 2016）</a>
							</div>

							<div class="content_gallery">
								<div class="gallery_item">
									<img src="./static/page2-1d.png" />
								</div>
							</div>

							<div class="pic_text">
								<p lang-id="picText_7">“疗愈性”感知由低到高的街景</p>
								<a href="https://kns.cnki.net/kcms2/article/abstract?v=3uoqIhG8C44YLTlOAiTRKibYlV5Vjs7i8oRR1PAr7RxjuAJk4dHXoklUCXziRe4nN7iQdbUpdIjhufeCZIXbCx8HnDWJU4U9&uniplatform=NZKPT"
									lang-id="picText_8">
									（图片来源：徐磊青, 等, 2020）</a>
							</div>

							<p lang-id="contentText_3">正文3</p>

							<div class="content_gallery">
								<div class="gallery_item">
									<img src="./static/page2-2a.png" />
								</div>
							</div>
							<div class="content_gallery">
								<div class="gallery_item">
									<img src="./static/page2-2b.png" />
								</div>
							</div>

							<div class="pic_text">
								<p lang-id="picText_9">物质构成相似的街景却有着完全不同的视觉感受</p>
							</div>

							<!-- 嵌入容器 + 视频 -->
							<div class="content_embedded">
								<div class="video_area">
									<video src="static/video.mp4" controls></video>
								</div>
							</div>
							<p lang-id="contentText_4">正文3</p>
						</div>
					</div>

					<div class="page_menu">
						<div class="page_change_btn next white" id="next-page">
							<img class="menu_icon" src="static/icon/next_black.svg" alt="" />
							<p lang-id="page_change_2">Next Page</p>
						</div>
					</div>
				</div>
			</div>
			<div class="swiper-slide">
				<div class="app">
					<div class="aside" id="aside">
						<!-- 侧边栏尺寸控制菜单 -->
						<div id="aside_menu" class="aside_menu" onclick="changeAside(event)">
							<img src="./static/icon/right.svg" alt="">
						</div>
						<!-- 侧边栏内容 -->
						<div class="page3_title" lang-id="indexing">HongKong Streetscape Indexing</div>
						<div class="range_container">
							<div class="range_item">
								<div class="label_container">
									<div class="range_label" id="x-label">
										<p lang-id="texture">
											纹理：
										</p>
										<p class="label_container_tips" lang-id="texture_tip">tips</p>
									</div>
								</div>
								<div class="range_btn_group">
									<span lang-id="range_btn_low">低</span>
									<div class="range_btn" id="range-btn-x"></div>
									<span lang-id="range_btn_hign">高</span>
								</div>
							</div>
							<div class="range_item">
								<div class="label_container">
									<div class="range_label" id="y-label">
										<p lang-id="shape">
											形状：
										</p>
										<p class="label_container_tips" lang-id="shape_tip">tips</p>
									</div>
								</div>
								<div class="range_btn_group">
									<span lang-id="range_btn_low">低</span>
									<div class="range_btn" id="range-btn-y"></div>
									<span lang-id="range_btn_hign">高</span>
								</div>
							</div>
							<div class="range_item">
								<div class="label_container">
									<div class="range_label" id="z-label">
										<p lang-id="color">
											色彩：
										</p>
										<p class="label_container_tips" lang-id="color_tip">tips</p>
									</div>
								</div>
								<div class="range_btn_group">
									<span lang-id="range_btn_low">低</span>
									<div class="range_btn" id="range-btn-z"></div>
									<span lang-id="range_btn_hign">高</span>
								</div>
							</div>
							<div class="layui-btn-container">
								<div class="layui-btn layui-btn-primary " id="draw-btn" lang-id="find_1">
									Find Geo-location
								</div>
								<div class="layui-btn layui-btn-primary " id="init-btn" lang-id="default">
									DEFAULT
								</div>
								<div class="layui-btn layui-btn-primary " id="draw-polygon" lang-id="find_2">
									绘制
								</div>
								<div class="layui-btn layui-btn-primary " id="hidden-polygon" lang-id="show_hide">
									隐藏/显示
								</div>
							</div>
						</div>
						<div class="page3_subtitle" lang-id="sub_title_2">
							<p>sub-title</p>
						</div>
						<div id="container" style="height: 500px"></div>

					</div>
					<div class="main">
						<div class="page_menu">
							<div class="page_change_btn pre black" id="pre-page">
								<img class="menu_icon" src="static/icon/next_black.svg" />
								<p lang-id="page_change_1">Last Page</p>
							</div>
						</div>
						<div class="page_intro_1" lang-id="indexing_intro_1">
							<p>
								intro_1
							</p>
						</div>
						<hr>
						<div class="page_intro_1" lang-id="indexing_intro_2">
							<p>intro_2</p>
						</div>
						<div class="page_intro_2" lang-id="indexing_intro_3">
							<p>intro_2</p>
						</div>
						<div class="page_intro_1" lang-id="indexing_intro_4">
							<p>intro_2</p>
						</div>
						<div class="page_intro_2" lang-id="indexing_intro_5">
							<p>intro_2</p>
						</div>
						<hr>
						<div class="page3_subtitle" lang-id="sub_title_1">
							<p>sub-title</p>
						</div>

						<!-- 图片渲染容器 -->
						<div class="pics" id="pics"></div>
						<div class="page_menu">
							<div class="page_change_btn next black" id="next-page">
								<img class="menu_icon" src="static/icon/next_black.svg" alt="" />
								<p lang-id="page_change_2">Next Page</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		function asideChangeFunction() {
			let asideFlex = 1

			return (event) => {
				const target = event.target
				const menu = document.getElementById("aside_menu")
				const aside = document.getElementById("aside")

				if (asideFlex === 1) {
					asideFlex = 3
					aside.style.flex = 3;
					menu.classList.add("open")
				} else {
					asideFlex = 1
					aside.style.flex = 1;
					menu.classList.remove("open")
				}
			}
		}

		const changeAside = asideChangeFunction();
	</script>

	<script type="module">
		import resolvePictures from "./src/resolvePictures.js";
		import pictureFunctionComponent from "./src/pictrueFunctionComponent.js";
		import rangeFunctionComponent from "./src/rangeFunctionComponent.js";
		import resolveConfig from "./src/resolveConfig.js";
		import resolveXLSX from "./src/resolveXLSX.js";
		import readData from "./src/readData.js";
		import {
			useRangeInput,
			useRangeInputCallback,
			ranges,
		} from "./src/useRangeInput.js";
		import { loadMap, readCoordinate } from "./src/loadMap.js";
		import useSwiper from "./src/useSwiper.js";

		//上一页和下一页按钮
		const prePage = document.querySelectorAll("#pre-page");
		const nextPage = document.querySelectorAll("#next-page");

		//页面滚动
		const { slideNext, slidePrev } = useSwiper({
			query: ".swiper",
		});

		for (let i = 0; i < prePage.length; i++) {
			prePage[i].onclick = () => {
				slidePrev();
			};
		}

		for (let i = 0; i < nextPage.length; i++) {
			nextPage[i].onclick = () => {
				slideNext();
			};
		}

		const LANGUAGE_KEY = "_lang";
		//加载语言的内容
		async function loadLangContent() {
			const lang = window.localStorage.getItem(LANGUAGE_KEY) || "en" || "zh";
			const langConfig = await import("./langConfig.js").then(
				(res) => res.default
			);
			const elementIds = Object.keys(langConfig);

			const targetAndContent = [];

			elementIds.forEach((elementId) => {
				const target = document.querySelectorAll(`[lang-id=${elementId}]`);
				let isConnection = false;
				let isImg = false;

				if (!(target instanceof HTMLElement)) {
					isConnection = true;
				}

				if (isConnection) {
					for (let i = 0; i < target.length; i++) {
						targetAndContent.push({
							target: target[i],
							content: langConfig[elementId][lang],
							attribute: langConfig[elementId]["attr"]
								? langConfig[elementId]["attr"]
								: null,
						});
					}
				} else {
					targetAndContent.push({
						target: target[i],
						content: langConfig[elementId][lang],
						attribute: langConfig[elementId]["attr"]
							? langConfig[elementId]["attr"]
							: null,
					});
				}
			});

			targetAndContent.forEach(({ target, content, attribute }) => {
				const type = target.tagName;

				if (attribute !== null) {
					target.setAttribute(attribute, content);
				} else {
					if (type === "IMG") {
						target.src = content;
					} else {
						target.innerHTML = content;
					}
				}
			});
		}

		//语言按钮
		const langBtns = document.querySelectorAll("#lang-btn");
		langBtns.forEach((btn) => {
			btn.addEventListener("click", () => {
				window.localStorage.setItem(
					LANGUAGE_KEY,
					btn.dataset.lang || "en" || "zh"
				);
				loadLangContent();
				slideNext();
			});
		});

		// ---------------------------------加载可自定义配置文件---------------------------------------------
		resolveConfig("./config.json").then(async (config) => {
			// ------------------------------统一获取dom元素------------------------------------------
			const container = document.getElementById("pics");
			const rangeContainer = document.getElementById("range-container");
			// const load = document.getElementById("load")
			const axisX = document.getElementById("x-label");
			const axisY = document.getElementById("y-label");
			const axisZ = document.getElementById("z-label");
			const initBtn = document.getElementById("init-btn");
			const drawBtn = document.getElementById("draw-btn");
			const drawPolygonElement = document.getElementById("draw-polygon");
			const hiddenPolygonElement = document.getElementById("hidden-polygon")

			const xyzDatas = []; //加载完的3个表格的数据

			// ----------------------------侧边栏坐标范围条-----------------------------------------
			function setPosition(targetXYZ) {
				const { targetX, targetY, targetZ } = targetXYZ;
				//   axisX.innerText = `纹理 Texture：[${targetX[0]},${targetX[1]}]`;
				//   axisY.innerText = `形状 Shape：[${targetY[0]},${targetY[1]}]`;
				//   axisZ.innerText = `色彩 Color：[${targetZ[0]},${targetZ[1]}]`;
			}

			const sliders = useRangeInput(
				[
					{
						id: "#range-btn-x",
						index: "x",
					},
					{
						id: "#range-btn-y",
						index: "y",
					},
					{
						id: "#range-btn-z",
						index: "z",
					},
				],
				{
					defaultRangeLeft: config.rangeDefaultValue[0][0],
					defaultRangeRight: config.rangeDefaultValue[0][1],
				},
				() => {
					const defaultValue = config.rangeDefaultValue[0];
					setPosition({
						targetX: defaultValue,
						targetY: defaultValue,
						targetZ: defaultValue,
					});
				}
			);

			// ---------------------------------阻塞渲染图片DOM---------------------------------------------
			const { updateSelectIdList, updateClickIdList, render, state, highlightDegree, hiddenDegree } =
				pictureFunctionComponent(container);
			await render(
				config.path[0],
				config.count[0],
				config.numberPerRow[0],
				config
			); //路径和需要渲染的图片数目

			// ---------------------------------加载地图和标记功能等--------------------------------------------
			// 阻塞加载坐标数据
			const coordinate = await readCoordinate();

			const { clearAndmark, drawPolygon } = loadMap("container", {
				markRadius: config.markRadius[0],
			});

			// 实现地图标点
			const polygonArr = []

			function getCoorinatesPath() {
				return polygonArr.map(item => {
					const paths = item.data.getPath()
					return paths.map(({ lat, lng }) => {
						return [lng, lat]
					})
				})
			}

			drawPolygonElement.onclick = function () {
				drawPolygon((polygonObject) => {
					polygonArr.push({
						data: polygonObject
					})

					const coordinatePaths = getCoorinatesPath()

					const countArr = []
					for (let i = 0; i < config.count[0]; i++) {
						const currentCoordinateArr = coordinate[i]

						// 筛选在其中一个多边形中的点
						const res = currentCoordinateArr.filter(([lat, lng]) => {
							let isInside = false
							for (let j = 0; j < coordinatePaths.length; j++) {
								const inside = AMap.GeometryUtil.isPointInRing(
									[lng, lat],
									[...coordinatePaths[j]]
								)

								if (inside) isInside = true
							}

							return isInside
						}).length
						countArr.push(res)
					}

					highlightDegree(countArr)
				})
			}

			hiddenPolygonElement.onclick = () => {
				hiddenDegree()
			}

			function clearPolygon() {
				polygonArr.forEach(item => {
					item.data.setMap(null)
				})
				polygonArr.splice(0)
				highlightDegree([])
			}

			// ----------------------------坐标数据-----------------------------------------
			const { calcIds, setXyzDatas } = rangeFunctionComponent();

			// ---------------------------------阻塞加载表格数据---------------------------------------------
			await readData("./data", ["C1.xlsx", "C2.xlsx", "C3.xlsx"]).then(
				(res) => {
					const datas = Array.from({ length: config.count[0] }).map(
						(item, index) => {
							return {
								x: res[0][index],
								y: res[1][index],
								z: res[2][index],
								id: index,
							};
						}
					);

					// load.innerText = load.getAttribute("value-success")
					// load.classList.add("success")
					setXyzDatas(datas);
				}
			);

			console.log(coordinate)
			// ----------------------------侧边栏地图-----------------------------------------

			//手动选择滑块之后的触发更新
			useRangeInputCallback(() => {
				// 计算处于滑块中的内容 -> 更新处于滑块中的图片的高亮状态
				const targetIds = calcIds(ranges, (targetXYZ) => {
					const { targetX, targetY, targetZ } = targetXYZ;
					setPosition(targetXYZ);
				});
				updateSelectIdList(targetIds);
			});

			//初始化滑块
			function initAxisRange() {
				const rangeDefaultValue = config.rangeDefaultValue[0];

				["x", "y", "z"].forEach((index) => {
					ranges[index].splice(0);
					ranges[index].push(rangeDefaultValue);
				});
				[0, 1, 2].forEach((index) => {
					sliders[index].setValue(rangeDefaultValue[0] * Math.pow(10, 15), 0);
					sliders[index].setValue(rangeDefaultValue[1] * Math.pow(10, 15), 1);
				});

				updateClickIdList([]);
				updateSelectIdList([]);
				drawMarker();
				clearPolygon()
			}

			// 标记点
			function drawMarker() {
				const markIds = [
					...state.selectIdList.map((selectId) => parseInt(selectId)),
					...state.clickIdList.map((clickId) => parseInt(clickId)),
				];

				clearAndmark(coordinate, markIds);
			}

			// 绑定默认加载的点击事件
			initBtn.onclick = initAxisRange;
			drawBtn.onclick = drawMarker;
		});
	</script>
</body>

</html>